<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adaptive Cross Approximation · FastBEAST.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="FastBEAST.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FastBEAST.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/manual/">General Usage</a></li><li><a class="tocitem" href="../../manual/application/">Application Examples</a></li></ul></li><li><span class="tocitem">Fast Methods</span><ul><li><a class="tocitem" href="../../fastmethods/hmatrix/">H-Matrix</a></li><li><a class="tocitem" href="../../fastmethods/fmm/">FMM</a></li></ul></li><li><span class="tocitem">Low Rank Approximations</span><ul><li class="is-active"><a class="tocitem" href>Adaptive Cross Approximation</a><ul class="internal"><li><a class="tocitem" href="#Convergence-Criteria"><span>Convergence Criteria</span></a></li><li><a class="tocitem" href="#Pivoting-Strategies"><span>Pivoting Strategies</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../clustering/">Clustering</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../apiref/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Low Rank Approximations</a></li><li class="is-active"><a href>Adaptive Cross Approximation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Adaptive Cross Approximation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FastBEAST/FastBEAST.jl/blob/main/docs/src/lowrankapprox/aca.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Adaptive-Cross-Aproximation"><a class="docs-heading-anchor" href="#Adaptive-Cross-Aproximation">Adaptive Cross Aproximation</a><a id="Adaptive-Cross-Aproximation-1"></a><a class="docs-heading-anchor-permalink" href="#Adaptive-Cross-Aproximation" title="Permalink"></a></h1><p>The adaptive cross approximation (ACA) is an adaptive rank revealing matrix factorization approach that computes the factorization of a low-rank matrix <span>$\bm A^{m\times n}$</span> </p><p class="math-container">\[    \bm A^{m\times n} \approx \widetilde{\bm A}^{m\times n} =  \bm U^{m\times r} \bm V^{r\times n}\,,\]</p><p>where ideally</p><p class="math-container">\[\lVert \bm A^{m\times n} - \widetilde{\bm{A}}^{m\times n} \rVert_\text{F} \leq \varepsilon \lVert \bm A^{m\times n}\rVert_\text{F}\,,\]</p><p>with the Forbenius norm <span>$\lVert \cdot \rVert_\mathrm{F}$</span> and the <span>$\varepsilon$</span> the tolerance of the approximation.</p><h5 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h5><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.aca</code>. Check Documenter&#39;s build log for details.</p></div></div><h5 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h5><pre><code class="language-julia hljs">using FastBEAST
using StaticArrays
using LinearAlgebra

function OneoverRkernel(testpoint::SVector{3,T}, sourcepoint::SVector{3,T}) where T
    if isapprox(testpoint, sourcepoint, rtol=eps()*1e1)
        return 0.0
    else
        return 1.0 / (norm(testpoint - sourcepoint))
    end
end

function assembler(kernel, testpoints, sourcepoints)
    kernelmatrix = zeros(
        promote_type(eltype(testpoints[1]),eltype(sourcepoints[1])), 
        length(testpoints),
        length(sourcepoints)
    )

    for i in eachindex(testpoints)
        for j in eachindex(sourcepoints)
            kernelmatrix[i,j] = kernel(testpoints[i], sourcepoints[j])
        end
    end

    return kernelmatrix
end

function assembler(kernel, matrix, testpoints, sourcepoints)
    for i in eachindex(testpoints)
        for j in eachindex(sourcepoints)
            matrix[i,j] = kernel(testpoints[i], sourcepoints[j])
        end
    end
end

N=1000
spoints = [@SVector rand(3) for i = 1:N]
tpoints = 0.1*[@SVector rand(3) for i = 1:N] + [SVector(2.0, 0.0, 0.0) for i = 1:N]
@views OneoverRkernelassembler(matrix, tdata, sdata) = assembler(
    OneoverRkernel, matrix, tpoints[tdata], spoints[sdata]
)
lm = LazyMatrix(OneoverRkernelassembler, Vector(1:N), Vector(1:N), Float64)
U, V = aca(lm; tol=1e-4)
</code></pre><h2 id="Convergence-Criteria"><a class="docs-heading-anchor" href="#Convergence-Criteria">Convergence Criteria</a><a id="Convergence-Criteria-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence-Criteria" title="Permalink"></a></h2><p>The computation of the true error of the factorization after the <span>$k$</span>th iteration is inefficient. Therefore, typically an approximation of the error is used.  This package provides the following convergence criteria.</p><h3 id="Standard-Convergence-Criterion"><a class="docs-heading-anchor" href="#Standard-Convergence-Criterion">Standard Convergence Criterion</a><a id="Standard-Convergence-Criterion-1"></a><a class="docs-heading-anchor-permalink" href="#Standard-Convergence-Criterion" title="Permalink"></a></h3><p>The standard convergence criterion used in the ACA checks after each iteration if </p><p class="math-container">\[\lVert \bm u_k \rVert \lVert \bm v_k \rVert \leq \varepsilon \lVert \widetilde{\bm{A}}_k^{m\times n} \rVert_\text{F}\,, \]</p><p>where <span>$\lVert \widetilde{\bm{A}}^{m\times n} \rVert_\text{F}$</span> can be computed efficiently by</p><p class="math-container">\[    \lVert \widetilde{\bm{A}}_k^{m\times n} \rVert_\text{F}^2 = \lVert \widetilde{\bm{A}}_{k-1}^{m\times n} \rVert_\text{F}^2 + 2 \mathcal{R}\left\{ \sum_{j=1}^{k-1} (\bm u_j^\ast \bm u_k) (\bm v_j^\ast \bm v_k)\right\} + (|\bm u_k||\bm v_k|)^2\]</p><h4 id="API-2"><a class="docs-heading-anchor" href="#API-2">API</a><a class="docs-heading-anchor-permalink" href="#API-2" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.Standard</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Random-Sampling-Convergence-Criterion"><a class="docs-heading-anchor" href="#Random-Sampling-Convergence-Criterion">Random Sampling Convergence Criterion</a><a id="Random-Sampling-Convergence-Criterion-1"></a><a class="docs-heading-anchor-permalink" href="#Random-Sampling-Convergence-Criterion" title="Permalink"></a></h3><p>The random sampling convergence criterion checks the mean true error of the approximation for a given subset of matrix entries in <span>$\bm A^{m\times n}$</span> after <span>$k$</span> iterations. Convergence is met if </p><p class="math-container">\[\sqrt{\text{mean}(|\bm{e}_r^2|)mn} \leq \varepsilon \lVert \widetilde{\bm{A}}_k^{m\times n} \rVert_F\,,\]</p><p>where <span>$\bm{e}_r$</span> contains the true error for the set of random samples after the <span>$k$</span>th iteration.</p><h4 id="API-3"><a class="docs-heading-anchor" href="#API-3">API</a><a class="docs-heading-anchor-permalink" href="#API-3" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.RandomSampling</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.RandomSampling(::Type{K}; factor=real(K)(1.0), nsamples=0) where K</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="CCC"><a class="docs-heading-anchor" href="#CCC">Combined Convergence Criterion</a><a id="CCC-1"></a><a class="docs-heading-anchor-permalink" href="#CCC" title="Permalink"></a></h3><p>The combined convergence criterion checks both the standard and random sampling criterion resulting in </p><p class="math-container">\[\text{max}(\lVert \bm u_k \rVert \lVert \bm v_k \rVert,\sqrt{\text{mean}(|\bm{e}_r^2|)mn}) \leq \varepsilon \lVert \widetilde{\bm{A}}_k^{m\times n} \rVert_F\,.\]</p><h4 id="API-4"><a class="docs-heading-anchor" href="#API-4">API</a><a class="docs-heading-anchor-permalink" href="#API-4" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.Combined</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.Combined(::Type{K}; factor=real(K)(1.0), nsamples=0) where K</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Pivoting-Strategies"><a class="docs-heading-anchor" href="#Pivoting-Strategies">Pivoting Strategies</a><a id="Pivoting-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Pivoting-Strategies" title="Permalink"></a></h2><p>The rows and columns of <span>$\bm A^{m \times n}$</span> used for the factorization are selected following a so called pivoting strategy. This package provides the following pivoting strategies.</p><h3 id="standardpiv"><a class="docs-heading-anchor" href="#standardpiv">Standard Partial Pivoting</a><a id="standardpiv-1"></a><a class="docs-heading-anchor-permalink" href="#standardpiv" title="Permalink"></a></h3><p>The standard partial pivoting selects the next row or column by the maximum value in modulo of the last column or row. </p><h4 id="API-5"><a class="docs-heading-anchor" href="#API-5">API</a><a class="docs-heading-anchor-permalink" href="#API-5" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.MaxPivoting</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.MaxPivoting(;firstindex=1)</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Fill-Distance-Pivoting"><a class="docs-heading-anchor" href="#Fill-Distance-Pivoting">Fill-Distance Pivoting</a><a id="Fill-Distance-Pivoting-1"></a><a class="docs-heading-anchor-permalink" href="#Fill-Distance-Pivoting" title="Permalink"></a></h3><p>The fill-distance pivoting selects the rows (or the columns) based on geometrical considerations, while the corresponding columns (or rows) are selected by the standard partial pivoting. The fill-distance requires for each row (or column) a corresponding node with a position which might be the vertex, edge, or face where a basis function is defined.  For a matrix <span>$A^{m\times n}$</span> we define the set <span>$X$</span> comprising all nodes corresponding to the rows. The rows used for the factorization are then selected such that the fill-distance </p><p class="math-container">\[    h_{X_k, X} = \mathrm{sup}_{x\in X}\,\mathrm{dist}(x, X_k)\]</p><p>is minimized from step <span>$k$</span> to step <span>$k+1$</span>, where <span>$X_k \subseteq X$</span> contains all nodes that are already selected. </p><h4 id="API-6"><a class="docs-heading-anchor" href="#API-6">API</a><a class="docs-heading-anchor-permalink" href="#API-6" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.FillDistance</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.FillDistance(pos::Vector{SVector{3, F}}) where F &lt;: Real</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="MFDPivoting"><a class="docs-heading-anchor" href="#MFDPivoting">Modified Fill-Distance Pivoting</a><a id="MFDPivoting-1"></a><a class="docs-heading-anchor-permalink" href="#MFDPivoting" title="Permalink"></a></h3><p>The modified fill-distance approach is in principle a fast implementation of the fill-distance pivoting with small modifications. The pivoting is also based on the fill-distance </p><p class="math-container">\[    h_{X_k, X} = \mathrm{sup}_{x\in X}\,\mathrm{dist}(x, X_k)\,.\]</p><p>But contrary to the fill-distance pivoting, where a numerically expensive minimization has to be computed the pivots are selected following</p><p class="math-container">\[    i_k = \mathrm{arg}\,\mathrm{max}_{x \in X}(\mathrm{dist}(x, X_{k-1}))\,.\]</p><p>The first pivot is selected as the basis-function closest to the barycenter of the set of nodes <span>$X$</span>. </p><h4 id="API-7"><a class="docs-heading-anchor" href="#API-7">API</a><a class="docs-heading-anchor-permalink" href="#API-7" title="Permalink"></a></h4><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.ModifiedFillDistance</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.ModifiedFillDistance(pos::Vector{SVector{3, F}}) where F &lt;: Real</code>. Check Documenter&#39;s build log for details.</p></div></div><h4 id="MRF-Pivoting"><a class="docs-heading-anchor" href="#MRF-Pivoting">MRF Pivoting</a><a id="MRF-Pivoting-1"></a><a class="docs-heading-anchor-permalink" href="#MRF-Pivoting" title="Permalink"></a></h4><p>The MRF pivoting strategy is an adaptive approach comprising the <a href="#standardpiv">standard partial pivoting</a>, the <a href="#MFDPivoting">modified fill-distance pivoting</a>, and a random sampling pivoting, where the active strategy is selected based on which criterion of the <a href="#CCC">combined convergence criterion</a> is met (details can be found in <a href="../../#refs">[4]</a>). </p><div align="center">
<img src="../../assets/algorithmhz.svg" width="responsive-image"/>
</div>
<br/><h5 id="API-8"><a class="docs-heading-anchor" href="#API-8">API</a><a class="docs-heading-anchor-permalink" href="#API-8" title="Permalink"></a></h5><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.MRFPivoting</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>FastBEAST.MRFPivoting(pos::Vector{SVector{I, F}}) where {I, F}</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../fastmethods/fmm/">« FMM</a><a class="docs-footer-nextpage" href="../../clustering/">Clustering »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 13 May 2024 10:46">Monday 13 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
